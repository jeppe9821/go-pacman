package pacman

import (
	_ "embed"

	"github.com/jeppe9821/go-pacman/audio"
	"github.com/jeppe9821/go-pacman/render"
)

type PacmanAudio struct {
}

type Pacman struct {
	pacmanMap      PacmanMap
	beginningAudio *audio.WavStream
	moveAudio      *audio.WavStream
}

func Create() Pacman {
	return Pacman{
		beginningAudio: audio.CreateWavStream("assets/sound/pacman_beginning.wav"),
		moveAudio:      audio.CreateWavStream("assets/sound/pacman_waka.wav"),

		pacmanMap: PacmanMap{
			player:      &Player{},
			spritesheet: render.LoadFromFile("assets/spritesheet.png"),
			grid: [][]int{ //28x31
				{2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 44, 43, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 1},
				{4, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 3},
				{4, 46, 24, 16, 16, 23, 46, 24, 16, 16, 16, 23, 46, 26, 25, 46, 24, 16, 16, 16, 23, 46, 24, 16, 16, 23, 46, 3},
				{4, 46, 26, 0, 0, 25, 46, 26, 0, 0, 0, 25, 46, 26, 25, 46, 26, 0, 0, 0, 25, 46, 26, 0, 0, 25, 46, 3},
				{4, 46, 28, 21, 21, 27, 46, 28, 21, 21, 21, 27, 46, 42, 41, 46, 28, 21, 21, 21, 27, 46, 28, 21, 21, 27, 46, 3},
				{4, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 3},
				{4, 46, 24, 16, 16, 23, 46, 24, 23, 46, 24, 16, 16, 16, 16, 16, 16, 23, 46, 24, 23, 46, 24, 16, 16, 23, 46, 3},
				{4, 46, 28, 21, 21, 27, 46, 26, 25, 46, 28, 21, 21, 36, 35, 21, 21, 27, 46, 26, 25, 46, 28, 21, 21, 27, 46, 3},
				{4, 46, 46, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 46, 46, 3},
				{6, 14, 14, 14, 14, 23, 46, 26, 37, 16, 16, 23, 46, 26, 25, 46, 24, 16, 16, 38, 25, 46, 24, 13, 13, 13, 13, 5},
				{0, 0, 0, 0, 0, 4, 46, 26, 35, 21, 21, 27, 46, 28, 27, 46, 28, 21, 21, 36, 25, 46, 3, 0, 0, 0, 0, 0},
				{0, 0, 0, 0, 0, 4, 46, 26, 25, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 26, 25, 46, 3, 0, 0, 0, 0, 0},
				{0, 0, 0, 0, 0, 4, 46, 26, 25, 46, 30, 14, 34, 0, 0, 33, 14, 29, 46, 26, 25, 46, 3, 0, 0, 0, 0, 0},
				{12, 12, 12, 12, 12, 27, 46, 28, 27, 46, 3, 0, 0, 0, 0, 0, 0, 4, 46, 28, 27, 46, 28, 11, 11, 11, 11, 11},
				{46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 3, 0, 0, 0, 0, 0, 0, 4, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46},
				{14, 14, 14, 14, 14, 23, 46, 24, 23, 46, 3, 0, 0, 0, 0, 0, 0, 4, 46, 24, 23, 46, 24, 13, 13, 13, 13, 13},
				{0, 0, 0, 0, 0, 4, 46, 26, 25, 46, 32, 12, 12, 12, 12, 12, 12, 31, 46, 26, 25, 46, 3, 0, 0, 0, 0, 0},
				{0, 0, 0, 0, 0, 4, 46, 26, 25, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 26, 25, 46, 3, 0, 0, 0, 0, 0},
				{0, 0, 0, 0, 0, 4, 46, 26, 25, 46, 24, 16, 16, 16, 16, 16, 16, 23, 46, 26, 25, 46, 3, 0, 0, 0, 0, 0},
				{2, 12, 12, 12, 12, 27, 46, 28, 27, 46, 28, 21, 21, 36, 35, 21, 21, 27, 46, 28, 27, 46, 28, 11, 11, 11, 11, 1},
				{4, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 3},
				{4, 46, 24, 16, 16, 23, 46, 24, 16, 16, 16, 23, 46, 26, 25, 46, 24, 16, 16, 16, 23, 46, 24, 16, 16, 23, 46, 3},
				{4, 46, 28, 21, 23, 25, 46, 28, 21, 21, 21, 27, 46, 28, 27, 46, 28, 21, 21, 21, 27, 46, 26, 35, 21, 27, 46, 3},
				{4, 46, 46, 46, 26, 25, 46, 46, 46, 46, 46, 46, 46, 46, 0, 46, 46, 46, 46, 46, 46, 46, 26, 25, 46, 46, 46, 3},
				{8, 16, 23, 46, 26, 25, 46, 24, 23, 46, 24, 16, 16, 16, 16, 16, 16, 23, 46, 24, 23, 46, 26, 25, 46, 24, 16, 7},
				{10, 21, 27, 46, 28, 27, 46, 26, 25, 46, 28, 21, 21, 36, 35, 21, 21, 27, 46, 26, 25, 46, 28, 27, 46, 28, 21, 9},
				{4, 46, 46, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 26, 25, 46, 46, 46, 46, 46, 46, 3},
				{4, 46, 24, 16, 16, 16, 16, 38, 37, 16, 16, 23, 46, 26, 25, 46, 24, 16, 16, 38, 37, 16, 16, 16, 16, 23, 46, 3},
				{4, 46, 28, 21, 21, 21, 21, 21, 21, 21, 21, 27, 46, 28, 27, 46, 28, 21, 21, 21, 21, 21, 21, 21, 21, 27, 46, 3},
				{4, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 3},
				{6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 5},
			},
		},
	}
}

func (pacman Pacman) Update(tick int) {
	pacman.beginningAudio.Play()
	pacman.pacmanMap.Update(tick)
}

func (pacman Pacman) Draw(screen render.Renderable) {
	pacman.pacmanMap.Draw(screen)
}
